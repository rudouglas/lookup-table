var __NR_MODULES="object"==typeof __NR_MODULES?__NR_MODULES:{};__NR_MODULES["9b97b997-11a4-442c-9e46-9f98861cf90f--lookup-table-viz"]=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="unset-public-path://9b97b997-11a4-442c-9e46-9f98861cf90f/";var n={__publicPath:function(e){r.p=e},__factory:function(t,r){const n=function(t,r,n,o){var a={};function u(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,u),r.l=!0,r.exports}return a[t]={i:t,l:!0,exports:r},a[n]={i:n,l:!0,exports:o},u.m=e,u.c=a,u.d=function(e,t,r){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(u.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(r,n,function(t){return e[t]}.bind(null,n));return r},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="unset-public-path://9b97b997-11a4-442c-9e46-9f98861cf90f/",u}("Xznc",t,"evsE",r);return n("wdv3")}};return n}({"+/pr":function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},"16Al":function(e,t,r){"use strict";var n=r("WbBG");function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,a,u){if(u!==n){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return r.PropTypes=r,r}},"17x9":function(e,t,r){e.exports=r("16Al")()},"44lk":function(e,t,r){var n=r("OXIC").default,o=r("C5op");e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.default=e.exports,e.exports.__esModule=!0},"8WoY":function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,r(t,n)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},C5op:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},FwQb:function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.default=e.exports,e.exports.__esModule=!0},OXIC:function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=r=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},RybX:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},"Uk+M":function(e,t,r){var n=r("8WoY");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},WbBG:function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},Xznc:function(e,t){e.exports=function(){throw new Error('Could not initialize "nr1"')}()},evsE:function(e,t){e.exports=function(){throw new Error('Could not initialize "__nr1-internal__"')}()},uPwZ:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},wdv3:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return O}));var n=r("RybX"),o=r.n(n),a=r("uPwZ"),u=r.n(a),c=r("C5op"),l=r.n(c),i=r("Uk+M"),f=r.n(i),s=r("44lk"),p=r.n(s),d=r("+/pr"),y=r.n(d),b=r("FwQb"),m=r.n(b),_=r("17x9"),x=r.n(_),h=r("Xznc");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var o=y()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p()(this,r)}}var v=r("evsE").injectedPackages.react,g=v.__esModule?v.default:v,T=["AS","COMPARE","EXTRAPOLATE","FACET","LIMIT","OFFSET","ORDER","SHOW","SINCE","SLIDE","TIMESERIES","UNTIL","WHERE","WITH"],O=function(e){f()(r,e);var t=E(r);function r(e){var n;return o()(this,r),n=t.call(this,e),m()(l()(n),"transformData",(function(e){return e.map((function(e){return{name:e.metadata.name,value:e.data[0].y}}))})),m()(l()(n),"formatTick",(function(e){return e.toLocaleString()})),m()(l()(n),"transformNrql",(function(e){var t=e.split("LOOKUP");return{mainQuery:t[0],lookupQuery:"FROM ".concat(t[1])}})),m()(l()(n),"parseQuery",(function(e){e.match(/(?<=from\s*)(.*?)(?=\s)/gi).find((function(e){return e}));var t=e.match(/(?<=select\s*)(.*?)(?=\s)/gi).find((function(e){return e})).replace("uniques(","").replace(")","");!function(e){var t=T.join("|"),r=new RegExp("since(.*?)(?=".concat(t,"|$)"),"i");e.match(r)[0]}(e.match(/since.*/i)[0]);return t})),m()(l()(n),"facetFilterTableClick",(function(e,t,r,o){var a=n.props.dashboardUrl;return a?(o.selectedPage=a,o.filters="".concat(e," = `").concat(t[e],"`")):o.filters=r?"".concat(r," AND ").concat(e," = `").concat(t[e],"`"):"".concat(e," = `").concat(t[e],"`"),h.nerdlet.setUrlState(o)})),m()(l()(n),"facetFilterBarClick",(function(e,t,r,o){var a=n.props.dashboardUrl,u=e.metadata.name;return o.filters=r?"".concat(r," AND ").concat(t," = '").concat(u,"'"):"".concat(t," = '").concat(u,"'"),a&&(o.selectedPage=a),h.nerdlet.setUrlState(o)})),m()(l()(n),"chunkArray",(function(e,t){var r,n,o=[];for(r=0,n=e.length;r<n;r+=t)o.push(e.slice(r,r+t));return o})),n.state={filters:"",dashboardUrl:null},n}return u()(r,[{key:"render",value:function(){var e=this,t=this.props,r=t.nrqlQueries,n=t.chartType;if(!(r&&r[0]&&r[0].accountId&&r[0].query))return g.createElement(S,null);var o=this.transformNrql(r[0].query),a=o.mainQuery,u=o.lookupQuery;console.log({mainQuery:a,lookupQuery:u});var c=this.parseQuery(u);return g.createElement(h.NerdletStateContext.Consumer,null,(function(t){var o=t.filters,l="".concat(u).concat(o?" WHERE ".concat(o):"");return g.createElement(h.NrqlQuery,{query:l,accountId:parseInt(r[0].accountId),pollInterval:h.NrqlQuery.AUTO_POLL_INTERVAL},(function(u){var i=u.data,f=u.loading,s=u.error;if(f)return g.createElement(h.Spinner,null);if(s)return g.createElement(P,null);var p,d=i[0].data.map((function(e){return"'".concat(e[c].replace(/'/g,"\\'"),"'")})),y="".concat(d.join(",")),b="WHERE ".concat(c," IN (").concat(y,")"),m="".concat(a," ").concat(b);return l.includes("WHERE")||!m.length>=2e4?p="".concat(a," ").concat(b):(p=a,"The query is too long to be run on the server. Please apply filters to narrow your results."),g.createElement(h.AutoSizer,null,(function(a){a.width,a.height;return g.createElement(h.NrqlQuery,{query:p,accountId:parseInt(r[0].accountId),pollInterval:h.NrqlQuery.AUTO_POLL_INTERVAL},(function(r){var a=r.data,u=r.loading,l=r.error;if(u)return g.createElement(h.Spinner,null);if(l)return console.log(l),g.createElement(P,null);var i=e.props.dashboardUrl;if(a){if("table"===n||!n)return g.createElement(h.Tooltip,{text:i?"Filter another dashboard":"Filter this dashboard"},g.createElement(h.TableChart,{data:a,onClickTable:function(r,n){return e.facetFilterTableClick(r,n,o,t)},fullHeight:!0,fullWidth:!0}));if("bullet"===n)return g.createElement(h.Tooltip,{text:i?"Filter another dashboard":"Filter this dashboard"},g.createElement(h.BarChart,{data:a,onClickBar:function(r){return e.facetFilterBarClick(r,c,o,t)},fullHeight:!0,fullWidth:!0}));if("billboard"===n)return g.createElement(h.BillboardChart,{data:a,fullHeight:!0,fullWidth:!0});if("line"===n)return g.createElement(h.LineChart,{data:a,fullHeight:!0,fullWidth:!0});if("area"===n)return g.createElement(h.AreaChart,{data:a,fullHeight:!0,fullWidth:!0});if("pie"===n)return g.createElement(h.PieChart,{data:a,fullHeight:!0,fullWidth:!0})}}))}))}))}))}}]),r}(g.Component);m()(O,"propTypes",{chartType:x.a.string,nrqlQueries:x.a.arrayOf(x.a.shape({accountId:x.a.number,query:x.a.string}))});var S=function(){return g.createElement(h.Card,{className:"EmptyState"},g.createElement(h.CardBody,{className:"EmptyState-cardBody"},g.createElement(h.HeadingText,{spacingType:[h.HeadingText.SPACING_TYPE.LARGE],type:h.HeadingText.TYPE.HEADING_3},"Please provide at least one NRQL query & account ID pair"),g.createElement(h.HeadingText,{spacingType:[h.HeadingText.SPACING_TYPE.MEDIUM],type:h.HeadingText.TYPE.HEADING_4},"An example NRQL query you can try is:"),g.createElement("code",null,"SELECT latest(Billable_GB_Ingested) FROM RunRateConsumptionWW_V1 facet Account_Name since 1 month ago limit max LOOKUP TechTeamLookupV1 SELECT Account_Name")))},P=function(){return g.createElement(h.Card,{className:"ErrorState"},g.createElement(h.CardBody,{className:"ErrorState-cardBody"},g.createElement(h.HeadingText,{className:"ErrorState-headingText",spacingType:[h.HeadingText.SPACING_TYPE.LARGE],type:h.HeadingText.TYPE.HEADING_3},"Oops! Something went wrong.")))}}});
//# sourceMappingURL=9b97b997-11a4-442c-9e46-9f98861cf90f--lookup-table-viz~014e625a.js.map